!! ------------------------------------------------------------------------
! model Hamiltonian to provide atomic shell populations and density matrix
! fitted to Mulliken DFT populations/q/BO/dipole
! SG, 2020-2021
! last change on method and fit parameters Tue Jun 27 08:52:20 CEST 2021
! HCNO FIT RMSD 15.46
!! ------------------------------------------------------------------------

subroutine shellq(pr,prop,n,ndim,nel,nopen,homo,at,chrg,xyz,z,rab, & 
&                 pnt,norm,S,psh,pa,P,wbo,dip,alp)
   use iso_fortran_env, only : wp => real64
   use parcom
   use bascom
   use com
   implicit none

!! ------------------------------------------------------------------------
!  Input
!! ------------------------------------------------------------------------
   logical, intent(in)    :: pr                 ! print
   integer, intent(in)    :: prop               ! type of property calc (0: p,q,P,WBO   1: +dip  2: + polar)
   integer, intent(in)    :: n                  ! number of atoms 
   integer, intent(in)    :: ndim               ! number of AOs       
   integer, intent(in)    :: nel                ! number of electrons 
   integer, intent(in)    :: nopen              ! number of open shells
   integer, intent(in)    :: homo               ! as the name says...
   integer, intent(in)    :: at(n)              ! ordinal number of atoms
   real(wp),intent(in)    :: chrg               ! system charge           
   real(wp),intent(in)    :: xyz(3,n)           ! coordinates (not used)
   real(wp),intent(in)    :: z(n)               ! nuclear charges          
   real(wp),intent(in)    :: rab(n*(n+1)/2)     ! distances  
   real(wp),intent(in)    :: pnt(3)             ! property reference point
   real(wp),intent(in)    :: norm(ndim)         ! SAO normalization factors
   real(wp),intent(in)    :: S(ndim*(ndim+1)/2) ! exact overlap maxtrix in SAO
!! ------------------------------------------------------------------------
!  Output
!! ------------------------------------------------------------------------
   real(wp),intent(out)   :: psh(10,n)          ! shell populations 
   real(wp),intent(out)   :: pa(n)              ! atom      "
   real(wp),intent(out)   :: P(ndim*(ndim+1)/2) ! density matrix
   real(wp),intent(out)   :: wbo(n,n)           ! WBOs                 
   real(wp),intent(out)   :: dip(3)             ! dipole moment
   real(wp),intent(out)   :: alp(6)             ! dipole polarizability tensor

!! ------------------------------------------------------------------------
!  local
!! ------------------------------------------------------------------------
   real(wp),allocatable :: Hdiag(:)                  ! diagonal
   real(wp),allocatable :: SS(:)                     ! scaled overlap/perturbed H
   real(wp),allocatable :: eps(:)                    ! eigenvalues
   real(wp),allocatable :: focc(:)                   ! occupations
   real(wp),allocatable :: d  (:,:)                  ! dipole integrals
   real(wp),allocatable :: P1   (:)                  ! perturbed P     
   real(wp),allocatable :: P2   (:)                  ! "
   real(wp)             :: dip1(3),dip2(3)
   real(wp)             :: alpha(3,3)         

!  global fit para
   real(wp),parameter   :: eT     = 300.00_wp   ! electronic temp. 
   real(wp),parameter   :: erfs   =-3.7500_wp   ! erf expo for both CN (1/2 orig. value)

   integer  :: i,j,k,l,ish,ati,atj,ia,ib,jsh,ii,jj,lin,ij,li
   integer  :: ns, iter
   integer  :: llao(4)
   data llao /1,3,5,7 /
   real(wp) :: r,rcovij,arg,tmp,hi,hj,hij,pol,eh1,xk,sk,t8,t9,gpol(2)
   real(wp) :: qscal2, pscal1, keht(6), qa, qb
   real(wp),allocatable :: cn(:), cns(:), gab(:,:), qeeq(:)
   real(wp),allocatable :: pdumsh(:,:),qdum(:)
   real(wp),allocatable :: S1(:,:), S2(:,:) !, X(:,:)
   real(wp),allocatable :: Hmat(:)
   logical fail

!! ------------------------------------------------------------------------
!  initizialization
!! ------------------------------------------------------------------------
   if(pr)then
   write(*,*) '----------------'
   write(*,*) '| shellQ model |'
   write(*,*) '| SG 2020-2021 |'
   write(*,*) '----------------'
   endif

   allocate( S1(ndim,ndim),S2(ndim,ndim) )   ! ,X(ndim,ndim))

   call mlpop1(ndim,S,S1,S2) ! ML precalc, x=1/4
   if(pr)write(*,*) 'ML setup done.'

   allocate( Hdiag(ndim), focc(ndim), SS(ndim*(ndim+1)/2), eps(ndim), &
  &          P1(ndim*(ndim+1)/2), Hmat(ndim*(ndim+1)/2), &
  &          P2(ndim*(ndim+1)/2), pdumsh(10,n), qdum(n), &
  &          gab(n,n), cn(n), cns(n), qeeq(n), source = 0.0_wp )

! for fit
   gpol(1)  = 0.423_wp    
   gpol(2)  = 0.300_wp   
   qscal2   = 0.258_wp   
   pscal1   = 0.400_wp   
   keht(1)  = 3.238_wp       
   keht(2)  = 2.773_wp    
   keht(3:6)= keht(2)  ! for 3rd-row elements (Si-Cl) this is totally sufficient

!  def CN
   call ncoord_erf(n,at,rab,erfs,cns) ! the org. EEQ was parameterized with erfs=-7.5
!  def EEQ charges pa in first iter
   call eeq(n,at,rab,chrg,cns,qeeq)

   if(pr)then
   write(*,*) 'EEQ done.'
   write(*,'(''sum q : '',f8.3)') sum(qeeq)
   write(*,'(''   atom      EEQ charges     defCN       specCN'')')
   endif

!  special CN
   cn = 0_wp
   do i = 2, n
      do j = 1, i-1 
         r = rab(lin(i,j))
         rcovij=abs(shell_cnf4(3,at(i)))+abs(shell_cnf4(3,at(j))) ! to avoid num. problems in fit if radius -> 0
         arg = (r-rcovij)/rcovij
         tmp = 0.5_wp * (1_wp + erf(erfs*arg)) 
         cn(i) = cn(i) + tmp      
         cn(j) = cn(j) + tmp 
      enddo
   enddo
   if(pr)then
   do i=1,n
       write(*,'(2i5,4f12.4)') i,at(i),qeeq(i),cns(i),cn(i) 
   enddo
   endif

!  DFTB second order term J matrix
   do i=1, n
      qdum(i) = 0.5_wp/(gam(at(i)) * (1_wp+cn(i)*shell_cnf4(7,at(i)))) ! CN scaled standard hardness
   enddo

   k = 0
   do i=1, n
      do j=1,i
         k = k + 1
         xk=qdum(i)+qdum(j)                   ! av.
         gab(j,i)=1_wp/sqrt(rab(k)**2+xk**2)  ! this choice is better and can be used with gamscal=1 (ie one parameter less)
!        gab(j,i)=1_wp/(rab(k)+xk)            ! damped Coulomb
         gab(i,j)=gab(j,i)
      enddo
   enddo

   call modbas(n,at,3) 
   call sint(n,ndim,at,xyz,rab,SS,eps)    ! scaled S 

   ! atomic H0        
   ii = 0
   do i = 1, n
      ati = at(i)
      t8  = cns(i)*shell_cnf4(9,ati) ! new, "normal" CN dep. shift
      do ish=1,bas_nsh(ati)
          tmp = shell_xi(ish,ati) + cn(i)*shell_cnf1(ish,ati) + t8 ! shell-wise + shell-wise CN + element-wise CN'
          l = bas_lsh(ish,ati)+1
          do j=1,llao(l)                                           ! AO loop
             ii = ii + 1
             Hdiag(ii) = tmp
          enddo
      enddo
   enddo

!! ------------------------------------------------------------------------
!  set up the H matrix twice
!! ------------------------------------------------------------------------

   P1 = 0    ! no H perturbation
   pa = qeeq ! initialization of atomic charges, true pa on output
   call twoscf(pr,n,ndim,nel,nopen,homo,at,z,rab,S,SS,P1,Hdiag,eps,focc,&
               eT,gab,S1,S2,pscal1,qscal2,gpol,keht,psh,pa,P,Hmat)

!! ------------------------------------------------------------------------
!  done
!! ------------------------------------------------------------------------

! properties: WBO
   call wiberg(n,ndim,at,rab,P,S,wbo)

! properties: dipole moment
   if(prop.eq.1.or.prop.eq.2)then
     allocate(d(ndim*(ndim+1)/2,3))
     call modbas(n,at,4) 
     call dipint(n,ndim,at,xyz,rab,norm,pnt,d)   ! dipole integrals
     call dipmom2(n,ndim,xyz,z,norm,P,d,pnt,dip) ! get dipole moment at point pnt
   endif

! properties: polarizability
   if(prop.eq.2)then
     xk  = 0.0002_wp  ! finite field step
     do k=1,3
!       simple perturbative treatment 
        call addsym(ndim, xk,Hmat,d(1,k),SS) ! perturb H
        call solve (ndim,nel,nopen,homo,eT,focc,SS,S,P1,eps,eh1,fail) ! solve
        call dipmom2(n,ndim,xyz,z,norm,P1,d,pnt,dip1) ! get new dipole moment
        call addsym(ndim,-xk,Hmat,d(1,k),SS) ! other direction
        call solve (ndim,nel,nopen,homo,eT,focc,SS,S,P1,eps,eh1,fail)
        call dipmom2(n,ndim,xyz,z,norm,P1,d,pnt,dip2)
        
! this more "SCF" like treatment yields totally inconsistent values for C60 and C70
!       P2(:)=xk*d(:,k) ! perturb H
!       qdum = qeeq 
!       call twoscf(.false.,n,ndim,nel,nopen,homo,at,z,rab,S,SS,P2,Hdiag,eps,focc,&
!                   eT,gab,S1,S2,pscal1,qscal2,gpol,keht,pdumsh,qdum,P1,Hmat)
!       call dipmom2(n,ndim,xyz,z,norm,P1,d,pnt,dip1) ! get new dipole moment
!       P2(:)=-xk*d(:,k) ! other direction
!       qdum = qeeq 
!       call twoscf(.false.,n,ndim,nel,nopen,homo,at,z,rab,S,SS,P2,Hdiag,eps,focc,&
!                   eT,gab,S1,S2,pscal1,qscal2,gpol,keht,pdumsh,qdum,P1,Hmat)
!       call dipmom2(n,ndim,xyz,z,norm,P1,d,pnt,dip2) ! get new dipole moment

        alpha(k,1:3)=-(dip1(1:3)-dip2(1:3))/(2_wp*xk) ! numerical diff. dmu/dfield
     enddo
     if(pr) call prmat(6,0.01_wp*alpha,3,3,'alpha a.u./100')
!    pol = pol / 3_wp
!    if(abs(alpha(1,2)-alpha(2,1))/pol.gt.1d-2) stop 'tensor not symmetric1'
!    if(abs(alpha(1,3)-alpha(3,1))/pol.gt.1d-2) stop 'tensor not symmetric2'
!    if(abs(alpha(2,3)-alpha(3,2))/pol.gt.1d-2) stop 'tensor not symmetric3'
     alp(1)=alpha(1,1)
     alp(2)=0.5*(alpha(2,1)+alpha(1,2))
     alp(3)=alpha(2,2)
     alp(4)=0.5*(alpha(3,1)+alpha(1,3))
     alp(5)=0.5*(alpha(3,2)+alpha(2,3))
     alp(6)=alpha(3,3)
   endif

end

!! ------------------------------------------------------------------------
!  set up and diag the H matrix twice
!! ------------------------------------------------------------------------

subroutine twoscf(pr,n,ndim,nel,nopen,homo,at,z,rab,S,SS,imat,Hdiag,eps,focc,&
                  eT,gab,S1,S2,pscal1,qscal2,gpol,keht,psh,pa,P,Hmat)
   use iso_fortran_env, only : wp => real64
   use bascom
   use parcom
   use com
   implicit none 
!! ------------------------------------------------------------------------
!  Input
!! ------------------------------------------------------------------------
   logical, intent(in)    :: pr                    ! print
   integer, intent(in)    :: n                     ! number of atoms 
   integer, intent(in)    :: ndim                  ! number of AOs       
   integer, intent(in)    :: nel                   ! number of electrons 
   integer, intent(in)    :: nopen                 ! number of open shells
   integer, intent(in)    :: homo                  ! as the name says...
   integer, intent(in)    :: at(n)                 ! ordinal number of atoms
   real(wp),intent(in)    :: z(n)                  ! nuclear charges          
   real(wp),intent(in)    :: rab(n*(n+1)/2)        ! distances  
   real(wp),intent(in)    :: S(ndim*(ndim+1)/2)    ! exact overlap maxtrix in SAO
   real(wp),intent(in)    :: SS(ndim*(ndim+1)/2)   ! scaled overlap maxtrix in SAO
   real(wp),intent(in)    :: imat(ndim*(ndim+1)/2) ! H initialization maxtrix 
   real(wp),intent(in)    :: Hdiag(ndim)           ! diagonal of H0
   real(wp),intent(in)    :: eps  (ndim)           ! orbital energies
   real(wp),intent(in)    :: focc (ndim)           ! fractional occ.
   real(wp),intent(in)    :: eT                    ! el. temp.
   real(wp),intent(in)    :: gab(n,n)              ! atomic ES interaction matrix
   real(wp),intent(in)    :: S1(ndim,ndim)         ! overlap
   real(wp),intent(in)    :: S2(ndim,ndim)         ! scaled overlap
   real(wp),intent(in)    :: pscal1,qscal2,gpol(2),keht(6) ! parameters

!! ------------------------------------------------------------------------
!  Output
!! ------------------------------------------------------------------------
   real(wp),intent(inout)   :: psh(10,n)             ! shell populations 
   real(wp),intent(inout)   :: pa(n)                 ! atom      "
   real(wp),intent(inout)   :: P(ndim*(ndim+1)/2)    ! density matrix
   real(wp),intent(inout)   :: Hmat(ndim*(ndim+1)/2) ! Hamiltonian matrix

!  local
   integer  :: i,j,k,l,ish,ati,atj,ia,ib,jsh,ii,jj,lin,ij,li,iter
   integer  :: itabrow6, ir, jr
   real(wp) :: r,tmp,pol,hi,hj,hij,eh1,xk,sk,t8,t9,qa,qb
   real(wp) :: ves(10,n), gq(n)
   logical  :: fail

   do iter=1, 2         ! two "iterations": in the first, q = q(EEQ)

   if(iter.eq.1) then   ! atom-wise ES, no shell pop available
      do i=1, n
         eh1 = 0_wp
         do l=1,n
            eh1=eh1+pa(l)*gab(l,i)  ! contraction with charge (DFTB term)
         enddo
         gq(i) = eh1 * pscal1 *0.5_wp
      enddo
   else                  ! shell-wise xTB like
      call setespot(n,at,psh,gab,ves) 
      ves = ves * 0.5_wp
   endif    

! H0 +  third-order (atomic charge exists in 1. and 2. iter)
   ij = 0
   Hmat=imat    ! zero or efield
   do i=1,ndim
      ia = aoat(i)
      ati= at(ia)
      ir = itabrow6(ati)
      ish= shell2ao(i)
      li = bas_lsh(ish,ati)+1
      hi = Hdiag(i)
      t8 = pa(ia)**2*shell_cnf4(1,ati)
      do j=1,i  
         ij = ij + 1
         if(abs(S(ij)).lt.1.d-9) cycle
         ib = aoat(j)
         hj = Hdiag(j)
         hij= hi+hj
         atj= at(ib)
         if(ia.ne.ib) then            ! different atoms
            jr  = itabrow6(atj)
            r   = rab(lin(ia,ib))
            xk  = shell_cnf4(2,ati)+shell_cnf4(2,atj)
            pol = ((hi-hj)/hij)**2
            tmp = 0.5_wp*(keht(ir)+keht(jr)) * SS(ij) * hij * (1_wp-pol*gpol(iter)) * (1_wp+xk/r)
         else                         ! same atoms
            tmp = SS(ij) * hij
            jsh = shell2ao(j)
            if(ish.ne.jsh) then       ! s-s', p-p' off-diagonal (there is no d-d' in MG VDZP)
               tmp = tmp * shell_cnf4(3+li,ati)  ! li=lj because S=0 otherwise
            endif
         endif
         t9=pa(ib)**2*shell_cnf4(1,atj)
         Hmat(ij) = Hmat(ij) + tmp - S(ij)*(t8+t9) ! third order diagonal
      enddo
   enddo

! H1
   if(iter.eq.1)then ! atom-wise, no +U (no P exists)
   ij = 0
   do i=1,ndim
      ia = aoat(i)
      do j=1,i  
         ib = aoat(j)
         ij = ij + 1
         Hmat(ij) = Hmat(ij) - (gq(ia)+gq(ib)) * S(ij) 
      enddo
   enddo
   else 
! shell-wise ES + U terms with density from 1. iter
   k = 0
   do i=1,ndim
      ia = aoat(i)
      ati= at(ia)
      ish= shell2ao(i)
      qa = pa(ia)+qscal2*pa(ia)**2
      hi = shell_cnf2(ish,ati)*(1_wp-qa*shell_cnf4(8,ati)) ! important charge scaling
      do j=1,i
         k  = k + 1
         ib = aoat(j)
         atj= at(ib)
         jsh= shell2ao(j)
         qb = pa(ib)+qscal2*pa(ib)**2
         hj = shell_cnf2(jsh,atj)*(1_wp-qb*shell_cnf4(8,atj))
         xk = (hi + hj)                                                    ! * (1_wp+gab(ib,ia)*glob_par(6))
         Hmat(k) = Hmat(k) + P(k) * xk - S(k)*(ves(ish,ia)+ves(jsh,ib))
      enddo
   enddo
   endif

   if(pr)write(*,*) 'shellQ H matrix iteration ',iter, ' done. Now diag ...'

!  solve 
   call solve (ndim,nel,nopen,homo,eT,focc,Hmat,S,P,eps,eh1,fail)
   if(fail) stop 'diag error'

   if(iter.gt.1.and.pr)then
     ii=max(homo-2,1)
     jj=min(homo+2,ndim)
     write(*,'('' frontier occ.: '',10f8.3)') focc(ii:jj)
     write(*,'('' gap          : '',  f8.3)') eps(homo+1)-eps(homo)
     if(eps(homo+1)-eps(homo).lt.0.02) write(*,*) 'WARNING: small HL gap!'
   endif

!  pop
   call mlpop2(n,ndim, P, S1, S2, pa, psh)
   if(iter.lt.2) pa = z - pa

   enddo

end

!! ------------------------------------------------------------------------
!  set up Coulomb potential due to 2nd order fluctuation shell-wise
!! ------------------------------------------------------------------------

subroutine setespot(n,at,qsh,jab,ves)
   use bascom
      implicit none 
      integer, intent(in)  :: n
      integer, intent(in)  :: at(n)
      real*8,  intent(in)  :: qsh(10,n),jab(n,n)
      real*8,  intent(out) :: ves(10,n) 

      integer i,j,ati,atj,ish,jsh
      real*8  vesi
      real*8  atocc(10)

      do i=1,n
         ati = at(i)
         do ish=1,bas_nsh(ati)
            vesi = 0
            do j=1,n   
               atj = at(j)
               do jsh=1,bas_nsh(atj)
                  call shellocc_ref(atj,atocc) ! ref. atomic pop.
                  vesi =vesi + (atocc(jsh)-qsh(jsh,j))*jab(j,i)
               enddo
            enddo
            ves(ish,i) = vesi
         enddo
      enddo

end  

!! ------------------------------------------------------------------------
!! neutral atomic shell occupations from r2SCAN-3c opt 
!! C2H6, CH3NH2, CH3OH
!! ------------------------------------------------------------------------

subroutine shellocc_ML(at,socc) ! shellQ based on wB97X-D3 ML(x=1/4)              
      use bascom
      implicit none
      integer at
      real*8 socc(*)

      socc(1:bas_nsh(at))=0

      select case (at)

      case (1) 
      socc( 1)=  0.534480053175
      socc( 2)=  0.405818421323
      socc( 3)=  0.059701525502
      case (3) 
      case (4) 
      case (5) 
      case (6) 
      socc( 1)=  0.578446469175
      socc( 2)=  0.324052365218
      socc( 3)=  1.820045889629
      socc( 4)=  1.208313837682
      socc( 5)=  0.069141438297
      case (7)
      socc( 1)=  0.694358181161
      socc( 2)=  0.488055901112
      socc( 3)=  2.234490331290
      socc( 4)=  1.539185424727
      socc( 5)=  0.043910161710
      case (8)
      socc( 1)=  0.882602145531
      socc( 2)=  0.590942331986
      socc( 3)=  2.708428625644
      socc( 4)=  1.786865163528
      socc( 5)=  0.031161733311
      case (9)
      end select

      end

!! ------------------------------------------------------------------------
!! neutral atomic shell occupations from r2SCAN-3c opt 
!! gtb coord -apo -qref
!! ------------------------------------------------------------------------

subroutine shellocc_ref(at,socc) 
      use bascom
      implicit none
      integer at
      real*8 socc(*)

      socc(1:bas_nsh(at))=0

      select case (at)

      case (1) ! c2h6
      socc( 1)=  0.533047627235
      socc( 2)=  0.408579869489
      socc( 3)=  0.058372503276
      case (2) ! heh+ 
      socc( 1)=  1.281397706549
      socc( 2)=  0.713829552965
      socc( 3)=  0.004772740486
      case (3) ! lih
      socc( 1)=  0.409565688560
      socc( 2)=  0.191757285436
      socc( 3)=  0.340235870385
      socc( 4)=  0.018214263048
      socc( 5)=  0.040226892572
      case (4) ! beh2
      socc( 1)=  0.685947888116
      socc( 2)=  0.308621403483
      socc( 3)=  0.646526998702
      socc( 4)=  0.307851605051
      socc( 5)=  0.051052104648
      case (5) ! b2h6
      socc( 1)=  0.552106361608
      socc( 2)=  0.233899678096
      socc( 3)=  1.345854343178
      socc( 4)=  0.762030308127
      socc( 5)=  0.106109308991
      case (6) ! c2h6
      socc( 1)=  0.571201906704
      socc( 2)=  0.323220026328
      socc( 3)=  1.827270260662
      socc( 4)=  1.206087153721
      socc( 5)=  0.072220652586
      case (7) ! n2h4
      socc( 1)=  0.720109002669
      socc( 2)=  0.484216257374
      socc( 3)=  2.229217660006
      socc( 4)=  1.496949883845
      socc( 5)=  0.069507196105
      case (8) ! h2o2
      socc( 1)=  0.957139137702
      socc( 2)=  0.638574629300
      socc( 3)=  2.666173232804
      socc( 4)=  1.692500432213
      socc( 5)=  0.045612567981
      case (9) ! hf
      socc( 1)=  1.026161598808
      socc( 2)=  0.681838249673
      socc( 3)=  3.183619297124
      socc( 4)=  2.098069014104
      socc( 5)=  0.010311840291
      case (10) ! neh+
      socc( 1)=  1.449221663867
      socc( 2)=  0.539293929032
      socc( 3)=  4.799503195859
      socc( 4)=  1.206852556561
      socc( 5)=  0.005128654682
      case (11) ! nah 
      socc( 1)=  0.059186811373
      socc( 2)=  0.553904448219
      socc( 3)=  0.312058923528
      socc( 4)=  0.017052854453
      socc( 5)=  0.057796962427
      case (12) ! mgh2  
      socc( 1)=  0.658325322782
      socc( 2)=  0.396018507733
      socc( 3)=  0.703816562424
      socc( 4)=  0.138982936940
      socc( 5)=  0.102856670121
      case (13) ! al2h6
      socc( 1)=  0.633418917174
      socc( 2)=  0.336953861007
      socc( 3)=  1.372801277879
      socc( 4)=  0.424269888354
      socc( 5)=  0.232556055585
      case (14) ! si2h6
      socc( 1)=  0.668726898902
      socc( 2)=  0.458688273846
      socc( 3)=  1.980924392864
      socc( 4)=  0.728999352795
      socc( 5)=  0.162661081593
      case (15) ! p2h4
      socc( 1)=  0.803207509565
      socc( 2)=  0.748576826399
      socc( 3)=  2.527289576203
      socc( 4)=  0.793490898340
      socc( 5)=  0.127435189492
      case (16) ! h2s2
      socc( 1)=  0.856202102739
      socc( 2)=  0.838272107562
      socc( 3)=  2.586129191291
      socc( 4)=  1.622224170289
      socc( 5)=  0.097172428119
      case (17) ! hcl
      socc( 1)=  0.856048863942
      socc( 2)=  0.943560207493
      socc( 3)=  3.290905101058
      socc( 4)=  1.879158515679
      socc( 5)=  0.030327311828
      case (18) ! arh+
      socc( 1)=  1.518322053732
      socc( 2)=  0.537946058498
      socc( 3)=  4.620458970609
      socc( 4)=  1.304083858045
      socc( 5)=  0.019189059117
      case (22) ! tih4
      socc( 1)=  0.773652174735
      socc( 2)=  1.793342658407
      socc( 3)=  0.275084118217
      socc( 4)=  0.530494908939
      socc( 5)=  6.190292841861
      socc( 6)=  0.020960992867
      socc( 7)=  1.774000342430
      socc( 8)=  0.642171962544
      end select

      end

!! ------------------------------------------------------------------------
!  normalize shell occ. to q_atom = 0, just to make shell_occ_ML 
!! ------------------------------------------------------------------------

subroutine qshnorm(z,nsh,qshref)
      implicit none
      integer nsh
      real*8  z,qshref(10)

      integer i
      real*8  norm, pol, val
      real*8  qshnew(10)     
      
      norm = sum(qshref(1:nsh))

      qshnew(1:nsh) = qshref(1:nsh) * z / norm

      do i=1,nsh
         write(*,'(6x,''socc('',i2,'')='',F16.12)') i, qshnew(i)
      enddo

end

   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   1.1295560020   0.6632672705   4.3698583191
   0.4793537008   0.2283019360  -0.1222480931   1.1260675023   0.1316724890  -0.0090202788   0.7823375333   0.5364242003   0.3703416118  -0.0096617046
           1
   1.4047890521   3.3877592791   0.0120979860   1.3449862446   0.7549976984   0.1099134748   2.7522604741  -0.1503442494   0.5365756400  -0.2225087422
  -0.0064810459  -0.0306589104  -0.0378218318   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.3938885224  -0.2282723186  -0.3229503068   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000  -0.2349096253
   0.7312702555   1.0195407268   0.9136507772   1.0000000000   1.0000000000   1.0000000000   1.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.1452614286   1.0445509007   0.7043550771   1.0000000000   1.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.3981666890  -0.2702478738  -0.3788594796  -0.2920572418   0.1247146151   0.0387056483   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.2983786413   0.8866833897   0.0635190216  -0.3600146841   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.3925502493  -0.1697026108  -0.0629338655   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0514953008  -0.1353061349   0.0096844256   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.5479207441  -0.8255670518   0.1961150215   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.8735250587   0.9396424864   0.5535209346   1.0000000000   1.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000843623   0.2379601432   0.0000000100   4.9932570410   0.0000000000   0.0000000000  -1.9472705445   1.7131091011   0.0384160986   0.0000000000
           2
   0.0010000000   0.0000000000   0.0000000000   1.5000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.5232170171  -0.1851887768  -0.1797915857   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.4807272094  -0.1147513949   0.0154269954   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0155507865  -0.4041632489   0.1836983961   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.7276040951   0.6800384190   0.8276999124   1.0000000000   1.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.2482756041  -0.0383791765   0.3190600158   4.7469405656   0.0000000000   0.0000000000  -2.0495777118   2.4756249927  -0.0010241004   0.0000000000
           3
   0.0010000000   0.0000000000   0.0000000000   1.5000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.3631374070  -0.2131035832  -0.2905249014  -0.2296282519  -0.1912448838   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1434612361   0.0006182888   0.0397775558   0.1428372280  -0.0114187183   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0143762652   0.0148242961  -0.0435376279   0.4264185161  -0.1006599676   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.0243202244   0.8151626620   1.1804545012   1.1607288619   0.7619963422   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0234119864   0.2043131501   1.6060283845   3.0221324532   3.4133900317   0.0000000000  -0.8616863324  -0.9547516838   0.0026522475   0.0000000000
           4
   0.0010000000   0.0000000000   0.0000000000   1.5000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.4442357415  -0.2337661661  -0.3359969003  -0.2298007770  -0.1804446243   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0201380394   0.0544004072  -0.0096323704   0.0122080510  -0.0051103040   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.1706664950   0.1285622066  -0.2290033189   0.1464509744  -0.2713123934   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.1626560067   1.0068897599   1.0900698408   1.1561690250   0.9473780314   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0156595156   0.0179356064   1.1947858682   3.1308978094   3.0423595492   0.0000000000  -0.2614502252  -1.9409559642  -0.0054520828   0.0000000000
           5
   0.0010000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.6422669186  -0.1941757089  -0.4233909430  -0.3350379221  -0.0954638462   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0074444600   0.0010918091   0.0018335099  -0.0011082961  -0.0198996691   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.2319077415  -0.0041791236  -0.2031828915   0.1615003066   0.0997489255   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.0221499699   0.9519698613   0.9278497626   1.1766204445   0.6868964212   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0693259616  -0.0123829366   1.1443635299   3.4373676008   1.7271188782   0.0000000000  -0.1920822432  -0.7740770676   0.0027576469   0.0000000000
           6
   0.5221619591   1.0444867606   0.0412527823  -0.1703216528   0.8519854209   0.3999304579   2.2097654463   0.0093977796   0.5705385387   0.6542265031
  -0.1627981303  -0.0883222521  -0.1809447702  -0.0537492485  -0.2360916681   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.2781370958  -0.2274810206  -0.3908894375  -0.2325624286  -0.2644912162   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.1115225684   0.8980910785   0.7733914956   0.9366360011   0.9201445886   1.0000000000   1.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.1278650941   0.9187598669   0.9378740741   0.9138530233   0.6288989719   0.0000000000   0.0000000000   1.0000000000   0.0000000000   0.0000000000
  -4.3297674162  -0.7589495029  -0.1347370489   0.0053050484  -0.0985958646   0.3340952142   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   2.6123963322   0.2944500088   0.0750839269   0.0004506181   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.4682162169  -0.1566014187  -0.4712049057  -0.2071500967  -0.1093305776   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0432275271   0.0022686707  -0.0195895656  -0.0056324724   0.0070388462   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1614274147  -0.1970621306   0.0412048734  -0.4217273289  -0.2263642497   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.0330489963   0.9664147493   1.0414215625   0.9789170267   0.8526245939   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0054393610   0.0933431071   1.2369913273   3.8766489286   3.0472892623   0.0000000000  -0.1171502340   1.2706848162  -0.0068573151   0.0000000000
           7
   0.3341290614   1.3571438940   0.8800150750   1.1012209892   0.8546132552   0.0341536278   4.1138833702  -1.2294198562  -1.6080833652  -0.0238796608
  -0.5465642043  -0.3476965594  -0.8025056906  -0.1152260252  -0.2433705164   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.2837756031   2.0220236470   1.2581590026   1.5007691670   0.8293677070   1.0000000000   1.0000000000   1.0000000000   1.0000000000   1.0000000000
  -0.9448086011  -0.3669183562  -0.1534615321  -0.2459255662  -0.8326456999   1.0000000000   1.0000000000   1.0000000000   1.0000000000   1.0000000000
   0.0374586152  -0.3368245163  -0.0085357846   1.6476676010  -0.0146484468   0.2271312528   0.1643326991   2.2978390410   0.0000000000   0.0000000000
  -1.1766583357  -1.3456239249  -1.5494475509  -0.9688569541  -1.5070878520   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.5806860425  -0.3904983045  -0.5451629048  -0.2526360203  -0.1909891694   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0544745273   0.0069020353  -0.0287695890  -0.0057872680   0.0250954578   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1239936712  -0.0589366338   0.0432025279  -0.3924044314  -0.1791293619   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.3228732310   1.0826152595   0.9512938089   1.0547668227   0.9209798749   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0137872349  -0.1497656303   1.5335810336   2.8546030389   2.2220894768   0.0000000000  -0.1515561919   1.0494434760  -0.0155938925   0.0000000000
           8
   0.3377671474   1.4402746378   0.8307550518   1.1160141142   0.7484303145  -0.0486656517   3.8543336447  -1.6630877672  -2.3436441267  -0.0305725483
  -0.5194780901  -0.3753399779  -1.0152394249  -0.1432617731  -0.3161191655   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.2158783908   2.2959070314   1.0267006715   1.1590934381   0.6558680302   1.0000000000   1.0000000000   1.0000000000   1.0000000000   1.0000000000
  -1.6747078540  -0.9632239994  -0.2571702627  -0.2668587890  -8.7473879377   1.0000000000   1.0000000000   1.0000000000   1.0000000000   1.0000000000
   0.0121093009  -0.1545688838  -0.0046033609   0.0464512347  -0.8813503850  -0.9740173501  -0.0488123178   0.1177384418   0.0000000000   0.0000000000
  -1.4137456789  -1.0133069747  -1.9156733869  -1.6926912866  -2.3921805456   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.8916418180  -0.6373895255  -0.5611345161  -0.2991355714  -0.2686743358   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0572951597  -0.0659752900  -0.0414110492  -0.0067421802   0.0233799098   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0425247214  -0.1436444143   0.0089906877  -0.2932201232  -0.0597583922   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.4149017883   1.1228899809   0.8380663117   1.1274223402   1.0023998606   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0173371904  -0.2224898356   1.4607879958   1.9628594212   1.8886144703   0.0000000000  -0.2428904719   1.3412105000  -0.0277470312   0.0000000000
           9
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.8940825904  -0.4357567901  -0.6792112292  -0.4228353934  -0.0221761549   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0251228791  -0.0392038562  -0.0290550517  -0.0116969934  -0.0482572187   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1048582165   0.0014496391  -0.0140180805  -0.2158153270   0.2660918336   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.2566548354   1.4358895411   0.8653414658   1.0628239917   0.5570863440   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0170561507  -0.1507089673   1.4294118402   1.9851440169   1.8804802409   0.0000000000  -0.1692039983   1.4808820362   0.0004666782   0.0000000000
          10
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -1.0309772098  -0.2019389881  -0.7132031688  -0.1170496851  -0.2910884707   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0103141917   0.1181971221  -0.2258947645  -0.1032145210  -0.0392311896   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.2282790622  -0.0104735386   0.0096492953   0.0850218181   0.1837124577   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.3043834714   0.8223538166   0.6865750844   0.9099223567   1.0617857560   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0108566050   0.6464780366   1.2000000000   5.8718326972   5.6812226981   0.0000000000  -0.2000000000   1.3316074160   0.0000000000   0.0000000000
          11
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.1548252425  -0.2973883490  -0.2746881068  -0.2272838827  -0.2332573180   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.1903976814   0.2338998302   0.1156451777  -0.0309631931   0.0276949963   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.2847522635  -0.1366834611   0.2586763364   1.0019793631  -0.1517420276   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.3148422042   1.3504253876   0.9404408159   1.0438139840   1.0386441370   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1272065315  -0.0913208744   1.6340972759   2.9041179235   2.1809043244   0.0000000000  -0.5120951317  -1.5375265449   0.0029681708   0.0000000000
          12
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.5295749170  -0.2169578856  -0.3538692318  -0.2098384994  -0.2947401716   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0868003452  -0.0233005012   0.0679694743  -0.0498003479   0.0807698670   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1878382991  -0.6290015995   0.0085371986  -0.3565773768  -0.0069014668   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.0253141875   1.0437179681   1.1658494289   1.1263928304   1.1478894856   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0254177414  -0.0236104778   1.5411000103   2.7572045032   2.7599597549   0.0000000000   0.9510072789  -0.1037139840  -0.0009735085   0.0000000000
          13
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.5671131584  -0.2995246160  -0.3978083834  -0.2161987791  -0.3203128363   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0025762315   0.0213303859  -0.0114207046  -0.0331970490   0.0036662960   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0409212493  -0.1889026162  -0.0118521274   0.0051757504  -0.0388874791   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.1844338558   1.0447425811   1.0227759055   1.1431135008   1.0298551719   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0140938979  -0.1182978585   1.7191611894   2.7462943128   3.1560317718   0.0000000000  -0.1040100886   2.3763320504   0.0057758477   0.0000000000
          14
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.4839581388  -0.1906565373  -0.4519166110  -0.1944250768  -0.3366611663   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0358571502   0.0044598331   0.0008161878  -0.0229825786   0.0105258882   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1772809898  -0.4873844493   0.0104242552  -0.1356176516   0.2248980639   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.0029130475   1.0101914392   1.0513766431   1.0170027972   1.0192390491   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0122966595   0.0533624306   1.8204955583   3.4134165629   2.9967109277   0.0000000000  -0.0385793100  -0.1712179211  -0.0015016117   0.0000000000
          15
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.4082163772  -0.3620932597  -0.5102149305  -0.2009721094  -0.3064978954   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0914790180   0.0580981736  -0.0055650167  -0.0373275627  -0.0002972261   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1770682930  -0.1172428352  -0.0697477590  -0.0069621429   0.0405436176   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.8874237608   1.2813531640   1.0207484971   1.0320302783   0.9715783451   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0263061232  -0.1802888004   1.6847033678   3.0610271976   2.5533029080   0.0000000000   0.0046583510  -1.0379581503  -0.0042976424   0.0000000000
          16
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.2525546171  -0.3916667057  -0.5082864256  -0.1826395265  -0.3469989153   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0477827295   0.0314027012  -0.0276236852  -0.0175950017   0.0130920762   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.1026455216  -0.0655716204   0.0604170369  -0.2765266731   0.2064032733   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.9691871727   1.0796214972   0.8869747477   0.9229026796   0.9974773979   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0065123540  -0.0523435405   2.0586416876   3.9781133723   3.1078993905   0.0000000000  -0.1146364455   0.8906666220  -0.0051107989   0.0000000000
          17
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.4215785538  -1.1666856678  -0.6295115397  -0.2237637245  -0.2854895872   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0349527968   0.1077459696  -0.0590958196  -0.0309883111  -0.0198354865   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0817715997   0.2580988263   0.0330665023  -0.3224318704   0.2491912761   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.0819188818   1.0942148853   0.9078487063   0.9426911000   0.8819005177   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0076452170  -0.2100256108   1.9311702480   2.9355303409   2.5157774619   0.0000000000  -0.1487378412   0.8832130450   0.0042080809   0.0000000000
          18
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.3006561662  -1.0527714071  -0.8784074241  -0.2205634672  -0.4352079361   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0091758939   0.0439428472  -0.1335903767  -0.0386232153  -0.0249858543   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.0347387657   0.0002010713   0.0489462813   0.0109603466   0.0970383658   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.9486572920   0.9479535100   1.1363434920   0.8820141472   1.0353300222   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0966924774   0.0508278179   1.5500000000   5.2093662015   4.3775871014   0.0000000000  -0.0500000000   1.3316074160   0.0000000000   0.0000000000
          22
   0.0010000000   0.0000000000   0.0000000000   1.1000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
  -0.3125226100  -0.9407696491  -0.2908445858  -0.1565194207  -0.5339791484  -0.1258571718  -0.3069116792  -0.1748931234   0.0000000000   0.0000000000
   0.0000231486   0.1438479029   0.0035549907   0.0040841103  -0.0555400386  -0.0000759988  -0.0000742804  -0.0336054563   0.0000000000   0.0000000000
   0.0037557650  -0.4257409650  -0.0015773759  -0.0683859596  -0.1306030824  -0.1185599570  -0.0032838177  -0.0908395057   0.0000000000   0.0000000000
   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000
   1.2052646324   0.9133878708   1.0079935028   1.0789148458   1.3316568217   0.8376906344   0.4934733285   0.7729820148   0.0000000000   0.0000000000
   0.0701377113   0.0747478404   2.7644337348   4.6241267094   3.9458900615   2.1238298627  -0.0571058829   0.6283314864  -0.0007557459   0.0000000000
